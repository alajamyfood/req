<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>نموذج طلب منتجات العجمي</title>

  <link rel="icon" href="favicon.ico">
  <link rel="icon" sizes="32x32" href="favicon-32x32.png">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="icon" sizes="192x192" href="android-chrome-192x192.png">

  <meta property="og:title" content="نموذج طلب منتجات العجمي">
  <meta property="og:description" content="اطلب منتجات العجمي الأصلية بسهولة">
  <meta property="og:image" content="logo.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="logo.png">

  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background: linear-gradient(to bottom, #006d77, #e0f7f4);
      margin: 0;
      padding: 15px;
      min-height: 100vh;
    }
    .container {
      background: rgba(255,255,255,0.95);
      border-radius: 16px;
      padding: 25px;
      max-width: 800px;
      margin: 0 auto;
      box-shadow: 0 8px 30px rgba(0,0,0,0.15);
    }
    .header { text-align: center; margin-bottom: 25px; }
    .logo-img { max-width: 300px; display: block; margin: 0 auto 15px; }
    h2 { color: #006d77; text-align: center; margin-bottom: 30px; font-size: 2rem; }
    label { display: block; margin: 10px 0 5px; font-weight: 600; color: #333; font-size: 1.1rem; }
    input, select, textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #a0d4cf;
      border-radius: 8px;
      font-size: 1.05rem;
      margin-bottom: 15px;
    }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
    th, td { padding: 12px; text-align: right; border-bottom: 1px solid #eee; }
    th { background: #e0f7f4; font-weight: 600; }
    .remove-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.95rem;
      position: absolute;
      top: 12px;
      left: 12px;
      z-index: 10;
    }
    .add-btn {
      background: #119da4;
      color: white;
      border: none;
      padding: 14px;
      border-radius: 8px;
      cursor: pointer;
      width: 100%;
      font-size: 1.1rem;
      margin-top: 15px;
    }
    button[type="submit"] {
      width: 100%;
      padding: 16px;
      background: linear-gradient(90deg, #119da4, #83c5be);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1.25rem;
      font-weight: 700;
      cursor: pointer;
      margin-top: 25px;
    }
    .note { text-align: center; font-size: 1rem; color: #555; margin-top: 15px; line-height: 1.5; }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <img src="logo.png" class="logo-img" alt="العجمي">
    <div class="since">Since 1989 • Al Ajamy</div>
  </div>
  <h2>نموذج طلب منتجات</h2>

  <form id="orderForm">
    <label>المحافظة / المدينة *</label>
    <input type="text" name="governorate" placeholder="مثال: غازي عنتاب – قونيا – أنطاليا – إسطنبول" required>

    <label>اسم الزبون *</label>
    <input type="text" name="customerName" placeholder="مثال: محمد أحمد" required>

    <label>تفاصيل المنتجات المطلوبة</label>
    <table>
      <thead>
        <tr>
          <th>المنتج</th>
          <th>الكمية</th>
          <th>الوزن</th>
          <th></th>
        </tr>
      </thead>
      <tbody id="itemsBody"></tbody>
    </table>
    <button type="button" class="add-btn" onclick="addRow()">+ إضافة صنف</button>

    <label>ملاحظات</label>
    <textarea name="notes" placeholder="أي تعليقات أو تفاصيل إضافية (اختياري)"></textarea>

    <button type="submit" id="submitBtn">إرسال الطلب</button>

    <div class="note">
      في حال وجود أي استفسار عن كيفية تعبئة الطلب التواصل على الواتس 00905345758221
    </div>
  </form>
</div>

<datalist id="product-list">
  <option value="001 عجمي حمص بالطحينة 325غ">
  <option value="002 عجمي كريم الثوم 230غ">
  <option value="003 عجمي متبل 230غ">
  <option value="004 عجمي حمص 450غ">
  <option value="005 عجمي حمص 300غ">
  <option value="006 عجمي حمص 225غ">
  <option value="007 عجمي كريم الثوم 225غ">
  <option value="008 عجمي متبل 450غ">
  <option value="009 عجمي متبل 225غ">
  <option value="010 زاد العربي حمص بالطحينة 230غ">
  <option value="011 زاد العربي كريم الثوم 230غ">
  <option value="012 زاد العربي متبل 230غ">
  <option value="013 الحمصاني حمص 230غ">
  <option value="014 الحمصاني كريم الثوم 230غ">
  <option value="015 الخال حمص 230غ">
  <option value="016 الخال كريم الثوم 230غ">
  <option value="017 الخال متبل 230غ">
  <option value="018 عجمي حمص بالكيلو">
  <option value="019 الحمصاني حمص بالكيلو">
  <option value="020 زاد العربي كريم الثوم بالكيلو">
  <option value="021 الحمصاني كريم الثوم بالكيلو">
  <option value="022 الخال كريم الثوم بالكيلو">
  <option value="023 MNZ كريم الثوم بالكيلو">
  <option value="024 عجمي متبل بالكيلو">
  <option value="025 حمص خام أسبتيك 20 كغ">
  <option value="026 2750غ عجمي لبنة">
  <option value="027 900غ عجمي لبنة">
  <option value="028 أبو عبدو حمص 300غ">
</datalist>

<script>
const productWeights = {
  "001 عجمي حمص بالطحينة 325غ": "325 غرام",
  "002 عجمي كريم الثوم 230غ": "230 غرام",
  "003 عجمي متبل 230غ": "230 غرام",
  "004 عجمي حمص 450غ": "450 غرام",
  "005 عجمي حمص 300غ": "300 غرام",
  "006 عجمي حمص 225غ": "225 غرام",
  "007 عجمي كريم الثوم 225غ": "225 غرام",
  "008 عجمي متبل 450غ": "450 غرام",
  "009 عجمي متبل 225غ": "225 غرام",
  "010 زاد العربي حمص بالطحينة 230غ": "230 غرام",
  "011 زاد العربي كريم الثوم 230غ": "230 غرام",
  "012 زاد العربي متبل 230غ": "230 غرام",
  "013 الحمصاني حمص 230غ": "230 غرام",
  "014 الحمصاني كريم الثوم 230غ": "230 غرام",
  "015 الخال حمص 230غ": "230 غرام",
  "016 الخال كريم الثوم 230غ": "230 غرام",
  "017 الخال متبل 230غ": "230 غرام",
  "018 عجمي حمص بالكيلو": "كيلو غرام",
  "019 الحمصاني حمص بالكيلو": "كيلو غرام",
  "020 زاد العربي كريم الثوم بالكيلو": "كيلو غرام",
  "021 الحمصاني كريم الثوم بالكيلو": "كيلو غرام",
  "022 الخال كريم الثوم بالكيلو": "كيلو غرام",
  "023 MNZ كريم الثوم بالكيلو": "كيلو غرام",
  "024 عجمي متبل بالكيلو": "كيلو غرام",
  "025 حمص خام أسبتيك 20 كغ": "20 كغ",
  "026 2750غ عجمي لبنة": "2750 غرام",
  "027 900غ عجمي لبنة": "900 غرام",
  "028 أبو عبدو حمص 300غ": "300 غرام"
};

let rowCounter = 0;

function addRow() {
  const tbody = document.getElementById('itemsBody');
  const index = rowCounter++;
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td>
      <input 
        list="product-list" 
        name="product[${index}]" 
        placeholder="اكتب أو اختر المنتج (مثال: 001 عجمي...)" 
        required
      >
    </td>
    <td>
      <input 
        type="number" 
        name="quantity[${index}]" 
        min="1" 
        placeholder="عدد الشنط / الطرود" 
        required
      >
    </td>
    <td>
      <select name="weight[${index}]">
        <option value="" selected disabled hidden>اختر الوزن</option>
        <option>325 غرام</option>
        <option>230 غرام</option>
        <option>450 غرام</option>
        <option>300 غرام</option>
        <option>225 غرام</option>
        <option>كيلو غرام</option>
        <option>2750 غرام</option>
        <option>900 غرام</option>
      </select>
    </td>
    <td><button type="button" class="remove-btn" onclick="this.closest('tr').remove()">حذف</button></td>
  `;
  tbody.appendChild(tr);

  tr.querySelector(`[name="product[${index}]"]`).addEventListener('input', function(e) {
    const selected = e.target.value.trim();
    const weightSelect = tr.querySelector(`[name="weight[${index}]"]`);
    if (productWeights[selected]) {
      weightSelect.value = productWeights[selected];
    }
  });

  rowCounter++;
}
addRow();

document.getElementById('orderForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const btn = document.getElementById('submitBtn');
  btn.disabled = true;
  btn.textContent = 'جاري الإرسال...';

  const formData = new FormData(this);
  const itemsCount = document.querySelectorAll('#itemsBody tr').length;

  fetch('https://script.google.com/macros/s/AKfycbzZhYFeTwTnh9VtoxmTWlSXeQKLvskfKxjBfvmf8_p9H6NIO2_uGurZ8FKF5npKVqeYvA/exec', {
    method: 'POST',
    body: formData
  })
  .then(r => r.text())
  .then(text => {
    try {
      const data = JSON.parse(text);
      if (data.status === 'success') {
        alert(`تم إرسال الطلب بنجاح ✅\nعدد الأصناف: ${itemsCount}`);
        document.getElementById('orderForm').reset();
        document.getElementById('itemsBody').innerHTML = '';
        rowCounter = 0;
        addRow();
      } else {
        alert('خطأ من السيرفر: ' + data.message);
      }
    } catch (e) {
      alert('تم الإرسال ظاهريًا، تحقق من الشيت يدويًا.');
    }
  })
  .catch(err => {
    alert('مشكلة في الاتصال: ' + err.message);
  })
  .finally(() => {
    btn.disabled = false;
    btn.textContent = 'إرسال الطلب';
  });
});
</script>
</body>
</html>
