<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"/>
  <title>نموذج طلب منتجات العجمي</title>

  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="android-chrome-192x192.png">

  <meta property="og:title" content="نموذج طلب منتجات العجمي">
  <meta property="og:description" content="اطلب منتجات العجمي الأصلية بسهولة">
  <meta property="og:image" content="logo.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="logo.png">

  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* ==== كل الـ CSS تبعك بدون أي تغيير ==== */
    :root {--turquoise-dark:#006d77;--turquoise-medium:#119da4;--turquoise-light:#83c5be;--turquoise-pale:#e0f7f4;--text-dark:#0d1f1f;--blur-bg:rgba(255,255,255,0.94);--border:#a0d4cf;}
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'Tajawal',sans-serif;background:linear-gradient(to bottom,var(--turquoise-dark),var(--turquoise-pale));background-attachment:fixed;color:var(--text-dark);padding:10px 8px;}
    .container{background:var(--blur-bg);backdrop-filter:blur(12px);border-radius:18px;padding:24px 20px;max-width:720px;margin:20px auto;box-shadow:0 10px 35px rgba(0,109,119,.25);border:1px solid rgba(131,197,190,0.3);}
    .header{text-align:center;margin-bottom:24px;}
    .logo-img{max-width:320px;width:100%;margin:auto;display:block;}
    h2{text-align:center;color:var(--turquoise-dark);margin-bottom:24px;font-size:1.9rem;}
    .form-group{margin-bottom:20px;}
    label{display:block;margin-bottom:8px;font-weight:600;font-size:1.05rem;}
    input,select,textarea{width:100%;padding:14px;border:1px solid var(--border);border-radius:10px;font-size:1.05rem;}
    table{width:100%;border-collapse:collapse;margin:12px 0 20px;}
    th,td{padding:12px 10px;text-align:right;border-bottom:1px solid #eee;}
    th{background:rgba(17,157,164,0.08);}
    .remove-btn{background:#e74c3c;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;}
    .add-btn{background:var(--turquoise-medium);color:#fff;border:none;padding:14px;border-radius:10px;cursor:pointer;width:100%;margin-top:12px;}
    button[type="submit"]{width:100%;padding:16px;margin-top:24px;font-size:1.2rem;font-weight:700;background:linear-gradient(90deg,var(--turquoise-medium),var(--turquoise-light));color:#fff;border:none;border-radius:12px;cursor:pointer;}
  </style>
</head>
<body>

<div class="container">
  <div class="header"><img src="logo.png" class="logo-img"></div>
  <h2>نموذج طلب منتجات</h2>

  <form id="orderForm">
    <div class="form-group">
      <label>المحافظة / المدينة *</label>
      <input type="text" name="governorate" required>
    </div>
    <div class="form-group">
      <label>اسم الزبون *</label>
      <input type="text" name="customerName" required>
    </div>

    <div class="form-group">
      <label>تفاصيل المنتجات المطلوبة</label>
      <table>
        <thead>
          <tr><th>المنتج</th><th>الكمية</th><th>الوزن</th><th></th></tr>
        </thead>
        <tbody id="itemsBody"></tbody>
      </table>
      <button type="button" class="add-btn" onclick="addRow()">+ إضافة صنف</button>
    </div>

    <div class="form-group">
      <label>ملاحظات</label>
      <textarea name="notes"></textarea>
    </div>

    <button type="submit" id="submitBtn">إرسال الطلب</button>
  </form>
</div>

<datalist id="product-list">
  <option value="001 عجمي حمص بالطحينة 325غ">
  <option value="002 عجمي كريم الثوم 230غ">
  <option value="003 عجمي متبل 230غ">
</datalist>

<script>
let rowCounter = 0;

function addRow() {
  const tbody = document.getElementById('itemsBody');
  const id = rowCounter++;
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td><input list="product-list" name="product_${id}" required></td>
    <td><input type="number" name="quantity_${id}" min="1" required></td>
    <td>
      <select name="weight_${id}">
        <option>230 غرام</option>
        <option>325 غرام</option>
        <option>450 غرام</option>
        <option>كيلو غرام</option>
      </select>
    </td>
    <td><button type="button" class="remove-btn" onclick="this.closest('tr').remove()">حذف</button></td>
  `;
  tbody.appendChild(tr);
}
addRow();

document.getElementById('orderForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const btn = document.getElementById('submitBtn');
  btn.disabled = true;
  btn.textContent = 'جاري الإرسال...';

  const formData = new FormData(this);
  const body = new URLSearchParams();

  body.append("governorate", formData.get("governorate"));
  body.append("customerName", formData.get("customerName"));
  body.append("notes", formData.get("notes") || "");

  let i = 0;
  while (formData.get("product_" + i)) {
    body.append("product_" + i, formData.get("product_" + i));
    body.append("quantity_" + i, formData.get("quantity_" + i));
    body.append("weight_" + i, formData.get("weight_" + i));
    i++;
  }

  fetch("https://script.google.com/macros/s/AKfycbxrpX-EdIjiMZNNQwCBnWmMBzJaSqRBY5oSIYyFV0a95kMuAco-1JHaFa3ICNbMKzPI/exec", {
    method: "POST",
    body: body
  })
  .then(r => r.json())
  .then(() => {
    alert("تم إرسال الطلب بنجاح ✅");
    document.getElementById('itemsBody').innerHTML = "";
    rowCounter = 0;
    addRow();
    this.reset();
  })
  .catch(() => alert("خطأ بالاتصال"))
  .finally(() => {
    btn.disabled = false;
    btn.textContent = "إرسال الطلب";
  });
});
</script>

</body>
</html>
